# Прямые на плоскости
На этом занятии мы научимся записывать уравнение прямой на плоскости и познакомимся с примерами того, как прямые используются в задачах машинного обучения.

## Разделяющая прямая
Представим, что перед нами стоит задача бинарной классификации: необходимо определить, к какому из двух заданных классов относится каждый имеющийся в выборке объект. Например, необходимо разделить пациентов на больных и здоровых или разделить электронные письма на спам и полезные письмма.

Допустим, что у каждого объекта есть только два признака. Тогда каждый объект можно представить как некоторую точку на плоскости. Один из спосопов решить задачу классификации в таком случае - разделить плоскость на две полуплоскости некоторой прямой. Тогда объекты по одну сторону от этой прямой можно отнести к первому классу, а объекты по другую сторону - ко второму классу.

Кроме того, по расстоянию от точки до разделяющей прямой можно определить, насколько алгоритм классификации "уверен" в разделении объектов на классы.

> Конечно, не всегда получится разделить точки на два класса прямой. Данные, для которых это возможно, называются **линейно разделимыми**.
![image](https://github.com/yuramayer/ml-math/assets/24956413/f40a4051-0675-474c-b675-4c7a6b3c52b1)

На озвученном подходе основана, в том числе, такая популярная группа алгоритмов классификации, как *SVM (support vector machhines)*. Разумеется, сегодня мы ещё не сможем написать свой алгоритм классификации, зато научимся записывать уравнение прямой на плоскости и вычислять расстояние от точки до прямой - эти дейтсвия лежат в основе подобных алгоримтов классификации.

## Уравнение прямой на плоскости
Общее уравнение прямой на плоскости имеет следующий вид:
$$Ax + By + C = 0,$$
где $`A, B, C`$ - некоторые вещественные числа, причём $`|A| + |B| \ne 0.`$

Любая прямая на плоскости может быть задана таким уравнением, и любое такое уравнение задаёт некоторую прямую на плоскости. 

Однако пока не ясно, как получить коэффициенты, чтобы записать такое уравнение для конкретной прямой. Давайте разбираться.

Для того, чтобы записать уравнение прямой, достаточно знать координаты какой-то точки, которая лежит на этой прямой, и вектор нормали.

> **Вектор нормали** - это ненулевой вектор, перпендикулярный данной прямой.

Обозначим искомую прямую буквой $`l`$, вектор нормали буквой $`n = (A_n, B_n)`$, и пусть точка, принадлежащей прямой, это $`m_0 = (x_0, y_0)`$. Перенесём вектор нормати так, чтобы он начинался из точки $`m_0`$:
![image](https://github.com/yuramayer/ml-math/assets/24956413/4418a236-578c-46e0-aef9-7253e6d240f5)

Рассмотирм произвольную точку $`m = (x, y)`$. Эта точка лежит на прямой $`l`$ тогда и только тогда, когда вектор $`\overline{m_0m}`$ перпендикулярен вектору нормали $`n`$. Здесь мы используем определение вектора из геометрии, вектор $`\overline(m_0m)`$ имеет координаты $`(x - x_0, y - y_0)`$. 

Если векторы перпендикулярны, то их скалярное произведение равно $`0`$. Отсюда получаем: $$\langle (A, B), (x - x_0, y - y_0) \rangle = 0. $$

Используем формулу вычисления скалярного произведения:
$$A(x - x_0) + B(y-y_0) = 0$$
Если раскрыть скобки и ввести обозначение $`C = Ax_0 - By_0`$, получим общее уравнение прямой:
$$Ax + By + C = 0$$

К примеру, найдём уравнение прямой, для которой вектор нормали $`n = (2, 3)`$, учитывая, что на этой прямой должна лежать точка $`(1, -2)`$. Подставим значения в формулу и упростим выражение:
$$A(x-x_0) + B(y-y_0) = 0$$ 
$$2(x - 1) + 3 (y + 2) = 0$$ 
$$2x + 3 y + 4 = 0$$ 
$$3y = -(2x + 4)$$ 
$$f(x) = - \frac{2x + 4}{3}$$

## Расстояние от точки до прямой
Теперь давайте научимся определять расстояние от произвольной точки до прямой, заданной общим уравнением.

Пусть $`k = (x_1, y_1)`$  - точка, расстояние от которой мы хотим найти. Тогда это расстояние можно вычислить по следующей формуле:
$$\frac{|Ax_1 + By_1 + C|}{\sqrt{A^2 + B^2}}$$

Например, найдём расстояние от точки $`(2, 1)`$ до прямой $`2x + 3y + 4 = 0 :`$
$$\frac{|2 \times 2 + 3 \times 1 + 4|}{\sqrt{2^2 + 3^2}} = $$
$$=\frac{|4 + 3 + 4|}{\sqrt{4 + 9}} = \frac{11}{\sqrt{13}}$$

Если же расстояние от точки до прямой окажется равным нулю, значит, точка лежит на данной прямой.



